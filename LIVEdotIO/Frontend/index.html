<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body id="myBody">

<button onclick="addNewDiv()">Add New Div</button>

<script id="scriptTag">

    var divsCreated = 0;

    var mainBody = document.getElementById("myBody");

    var elementToInsertBefore = document.getElementById("scriptTag");

    function createNewTemplateDiv(idPostfix) {
        var div = document.createElement("div");
        div.id = "newDiv" + idPostfix;

        var divHeading = document.createElement("h4");
        divHeading.id = "divHeading" + idPostfix;
        var divPara1 = document.createElement("p");
        divPara1.id = "divPara1_" + idPostfix;
        var divPara2 = document.createElement("p");
        divPara2.id = "divPara2_" + idPostfix;

        divHeading.appendChild(document.createTextNode("Heading " + idPostfix));
        divPara1.appendChild(document.createTextNode("Info 1"));
        divPara2.appendChild(document.createTextNode("Info 2"));

        div.appendChild(divHeading);
        div.appendChild(divPara1);
        div.appendChild(divPara2);

        // add the following styles below as CSS
        div.style.border = "thin solid #00bbbb";
        div.style.padding = "5px";
        div.style.margin = "5px";
        return div;
    }



    function addNewDiv() {
        divsCreated++;
        var div = createNewTemplateDiv(divsCreated);
        mainBody.insertBefore(div, elementToInsertBefore);
        elementToInsertBefore = div;
    }

</script>


<script src="/socket.io/socket.io.js"></script>
<script id="socketioScripts">
    var socket = io();

    socket.on('m3', function(infoObj) {
        if(infoObj.addOrRemove == "a") {
            // check if the view already exists
            var viewToAdd = document.getElementById("newDiv"+infoObj.eventName);
            if(viewToAdd == null) { // if it does not exist -> create it first
                var div = createNewTemplateDiv(infoObj.eventName);
                mainBody.insertBefore(div, elementToInsertBefore);
                elementToInsertBefore = div;
            }
            // update the LIVEdotIO view with the message in the object
            var elt = document.getElementById("divPara1_"+infoObj.eventName);
            if(elt) {
                elt.innerHTML = infoObj.message;
            }
        }
        else { // it is a LIVEdotIO view removal
            // check if the view already exists
            var viewToRemove = document.getElementById("newDiv" + infoObj.eventName);
            if (viewToRemove != null) {
                mainBody.removeChild(viewToRemove)
            }
        }
    });

    socket.on('m2', function(msg) {
        var elt = document.getElementById("divPara1_2");
        if(elt) {
            elt.innerHTML = msg;
        }
    });

    socket.on('m1', function(msg) {
        var elt = document.getElementById("divPara1_1");
        if(elt) {
            elt.innerHTML = msg;
        }
    });

</script>

</body>
</html>