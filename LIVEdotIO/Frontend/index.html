<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body >

<button onclick="addNewDiv()">Add New Div</button>

<main id="myBody">

<script id="scriptTag">

    var divsCreated = 0;
    var mainBody = document.getElementById("myBody");
    var elementToInsertBefore = document.getElementById("scriptTag");

    function createNewTemplateDiv(idPostfix) {
        var div = document.createElement("div");
        var idPrefix = "";
        div.id = idPrefix + idPostfix;

        var divHeading = document.createElement("h4");
        divHeading.id = "divHeading" + idPostfix;
        var divPara1 = document.createElement("p");
        divPara1.id = "divPara1_" + idPostfix;
        var divPara2 = document.createElement("p");
        divPara2.id = "divPara2_" + idPostfix;

        divHeading.appendChild(document.createTextNode("Heading " + idPostfix));
        divPara1.appendChild(document.createTextNode("Info 1"));
        divPara2.appendChild(document.createTextNode("Info 2"));

        div.appendChild(divHeading);
        div.appendChild(divPara1);
        div.appendChild(divPara2);

        // add the following styles below as CSS
        div.style.border = "thin solid #00bbbb";
        div.style.padding = "5px";
        div.style.margin = "5px";
        return div;
    }


    function addNewDiv() {
        divsCreated++;
        var div = createNewTemplateDiv(divsCreated);
        mainBody.insertBefore(div, elementToInsertBefore);
        elementToInsertBefore = div;
    }

</script>


<script src="/socket.io/socket.io.js"></script>
<script id="socketioRecvScripts">
    var socket = io();

    // removal code
    socket.on('r', function(infoObj) {
        // check if the view already exists (view IDs will be named after the event)
        var viewToRemove = document.getElementById(infoObj.eventName);
        if(viewToRemove != null) {
            mainBody.removeChild(viewToRemove)
        }
    });

    // addition/update code
    socket.on('a', function(infoObj) {
        // check if the view already exists (view IDs will be named after the event)
        var viewToAdd = document.getElementById(infoObj.eventName);
        if(viewToAdd == null) { // if it does not exist -> create it first
            var div = createNewTemplateDiv(infoObj.eventName);
            mainBody.insertBefore(div, mainBody.firstElementChild);
            elementToInsertBefore = div;
        }
        // update the LIVEdotIO view with the message in the object
        var elt = document.getElementById("divPara1_"+infoObj.eventName);
        if(elt) {
            elt.innerHTML = infoObj.message;
        }
    });


</script>

</main>
</body>
</html>
