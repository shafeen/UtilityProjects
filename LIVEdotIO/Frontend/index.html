<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body >

<main id="myBody">

<script id="scriptTag">

    var mainBody = document.getElementById("myBody");
    var elementToInsertBefore = document.getElementById("scriptTag");

    // LIVEdotIO view
    function createNewTemplateDiv(idPostfix) {
        var div = document.createElement("div");
        var idPrefix = "";
        div.id = idPrefix + idPostfix;

        var divHeading = document.createElement("h4");
        divHeading.id = "divHead_" + idPostfix;
        var divPara1 = document.createElement("p");
        divPara1.id = "divPara1_" + idPostfix;
        var divPara2 = document.createElement("p");
        divPara2.id = "divPara2_" + idPostfix;

        divHeading.appendChild(document.createTextNode("Heading " + idPostfix));
        divPara1.appendChild(document.createTextNode("Info 1"));
        divPara2.appendChild(document.createTextNode("Info 2"));

        div.appendChild(divHeading);
        div.appendChild(divPara1);
        div.appendChild(divPara2);

        // add the following styles below as CSS
        div.style.border = "thin solid #00bbbb";
        div.style.padding = "5px";
        div.style.margin = "5px";
        return div;
    }


    function addNewLDIView(viewName) {
        var div = createNewTemplateDiv(viewName);
        mainBody.insertBefore(div, mainBody.firstElementChild);
    }

    function removeLDIView(viewName) {
        // Note: view IDs will be named after the event received
        var viewToRemove = document.getElementById(viewName);
        if(viewToRemove != null) {
            mainBody.removeChild(viewToRemove)
        }
    }

    // Note: we assume that ldiModel properties match ldiView children ids 1:1
    function updateLDIViewData(ldiModel) {
        // Note: view MUST contain the elements whose IDs match the model's attributes
        for(var ldiModelAttr in ldiModel) {
            if(ldiModel.hasOwnProperty(ldiModelAttr)) {
                document.getElementById(ldiModelAttr).innerHTML = ldiModel[ldiModelAttr];
            }
        }
    }


</script>


<script src="/socket.io/socket.io.js"></script>
<script id="socketioRecvScripts">
    var socket = io();

    // removal code
    socket.on('r', function(infoObj) {
        removeLDIView(infoObj.eventName)
    });

    // addition/update code
    socket.on('a', function(infoObj) {
        // check if the view already exists (view IDs will be named after the event)
        var viewToAdd = document.getElementById(infoObj.eventName);
        if(viewToAdd == null) { // if it does not exist -> create it first
            addNewLDIView(infoObj.eventName);
        }
        // update the LIVEdotIO view with the message in the object
        updateLDIViewData(infoObj.ldiModel);

    });

</script>


</main>
</body>
</html>
